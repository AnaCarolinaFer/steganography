# Esteganografia e SVD

Grupo:  
Andrew da Silva Faria  
Paulo Michel Yamagishi Fajardo  
Ana Carolina Ferreira de Figueiredo

## O que é Esteganografia?

Esteganografia é a arte de esconder informações secretas dentro de mensagens não secretas. Isso pode parecer criptografia, mas não são exatamente a mesma coisa. Criptografia torna mensagens incompreensíveis, enquanto esteganografia esconde que a mensagem sequer existe. Para mostrar o quão importante isso é, imagine que a pessoa A queira enviar uma mensagem secreta para a pessoa B. Se for obviamente uma mensagem secreta, a pessoa C pode simplesmente cortar a comunicação entre os dois. Mas se a mensagem for inocente, como uma imagem, a pessoa C nem sequer percebe que há uma comunicação mais profunda ocorrendo. Muitas técnicas esteganográficas, por exemplo, escondem dados dentro de arquivos. Seu principal objetivo é que esses dados não sejam percebidos por terceiros; ou seja, a presença de mensagens escondidas dentro de arquivos é simplesmente desconhecida. Somente o receptor da mensagem tem conhecimento de sua existência, assim como da maneira como extraí-la.

Muitos são os meios utilizados para a aplicação da esteganografia. Mensagens podem ser escondidas em imagens, por exemplo, utilizando-se de algumas técnicas específicas, como a do bit menos significativo, que será descrita [mais adiante](https://www.gta.ufrj.br/grad/09\_1/versao-final/stegano/tecnicas.html\#lsb). Além de imagens, arquivos de áudio também podem ser usados para ocultar mensagens, de maneira que estas não sejam percebidas por quem estiver ouvindo o som. No entanto, é relevante notar que as técnicas também possuem algumas restrições. Por exemplo, o tamanho das informações a serem escondidas é limitado pelo tamanho do próprio meio que será utilizado. Quanto menos essas informações degradarem a aparência dos arquivos, maior é o potencial das técnicas esteganográficas. Geralmente, mensagens muito grandes acabam ferindo a integridade do meio, o que corrobora para uma fácil detecção de que uma possível mensagem foi escondida no arquivo.

## Técnica Least Significant Bits

É uma das técnicas de esconder informações em imagens JPEG, usando o ruído e ela consiste em usar os bits menos significativos para guardar os dados que se deseja camuflar. Em uma imagem JPEG, trocar os bits menos significativos pode mudar a intensidade de um pixel em no máximo 1%. A idéia se baseia na propriedade de que imagens JPEG possuem redundância. Assim, os bits menos significativos podem ser utilizados como bits redundantes para esconder uma mensagem. Esse tipo de técnica não deixa rastros perceptíveis para análises visuais do arquivo. Um ser humano não consegue perceber um rastro de informação em um padrão binário complicado e complexo, o que é característico de um ruído. Portanto, a idéia é dividir os planos de bits de uma imagem BMP, PNG ou JPG em regiões com ruídos e sem ruídos, guardando os blocos de dados, provenientes das mensagens que se deseja camuflar, nas regiões que possuem ruídos. Dessa forma, não haveria como identificar a presença de mensagens escondidas, já que as regiões complexas das imagens foram substituídas por outros padrões binários, o que é invisível para o olho humano. Através dessa técnica, a qualidade da imagem não é prejudicada. A razão dessa característica diz respeito à inserção das mensagens, a qual é realizada até que a imagem tenha somente dados indispensáveis. 

## O que é SVD? 

SVD é a decomposição em valores singulares. SVD serve como a fatorização de uma matriz e a generalização da sua decomposição em autovalores. Essencialmente, o que estamos fazendo é fatorizar uma matriz A em outras três matrizes: U, S e depois Vt, nessa ordem: 

* Matriz U:

*U* consiste nos autovetores ordenados da matriz *AAt*, onde At representa a transposta de *A*. Os autovetores são vetores especiais que não mudam de direção quando multiplicados pela matriz *AAt*. Eles representam os eixos de um espaço de alta dimensão onde os dados de *A* estão distribuídos. Os autovetores em *U* são ordenados de forma que os primeiros autovetores capturam a maior parte da variabilidade nos dados.

* Matriz *S*:

*S* é uma matriz diagonal que contém os valores singulares de  *A*, que são as raízes quadradas dos autovalores compartilhados de *U* e *V*. Os valores singulares em  
*S* indicam a importância relativa dos autovetores em *U* e *Vt.*  Valores singulares maiores indicam direções de maior variabilidade nos dados. A diagonal de *S* é ordenada de forma decrescente, com os maiores valores singulares na diagonal superior esquerda.

* Matriz *VT*:

*Vt* é a transposta dos autovetores da matriz *AtA*. Assim como em *U*, os autovetores em *VT*  representam os eixos de um espaço de alta dimensão, mas neste caso, é o espaço definido pelos atributos de *A*. Os autovetores em *VT*  também são ordenados de forma que os primeiros autovetores capturam a maior parte da variabilidade nos atributos de *A*.

## Papel do SVD na Esteganografia

O SVD pode ser usado para dividir uma imagem em suas componentes fundamentais, como o conteúdo principal (representado pelos maiores valores singulares) e o ruído (representado pelos menores valores singulares). A mensagem secreta pode então ser codificada nos componentes de baixa importância, ou seja, nos valores singulares menores, de forma que a alteração seja menos perceptível visualmente na imagem. A decomposição SVD pode ser usada para garantir que a mensagem secreta seja robusta contra ataques de esteganálise, nos quais um observador tenta detectar a presença de mensagens secretas. Isso pode ser feito espalhando a mensagem secreta em várias partes da imagem usando diferentes componentes da decomposição SVD.  Então, basicamente,  divide-se a imagem em blocos de 4x4 pixels e o SVD é aplicado a cada bloco de 4x4 pixels separadamente. Isso resulta na decomposição do bloco em três componentes: *U*, *S* e Vt

### Porque dividir a imagem em blocos?

* Dividir a imagem em blocos menores simplifica o processamento, especialmente quando se trabalha com grandes imagens. Processar pequenos blocos de cada vez pode reduzir a carga computacional e facilitar a implementação de algoritmos.  
* Ocultar informações em pequenos blocos de pixels pode reduzir o impacto visual das alterações feitas na imagem. Em comparação com a modificação de toda a imagem, a alteração de pequenos blocos pode tornar as mudanças menos perceptíveis aos olhos humanos.  
* Dividir a imagem em blocos também pode aumentar a resiliência do método esteganográfico contra ataques de esteganálise. Se um bloco for comprometido, apenas uma parte da mensagem oculta será revelada, em vez da mensagem inteira.

## Funcionamento do Algoritmo

Houve duas características do SVD que foram chaves nas funções do MATLAB que usamos. A primeira função foi apenas a função básica do SVD, que era nossa função principal e realiza o SVD em uma matriz dada e retorna U, S e V como variáveis individuais. A próxima função foi strcat, que recebe múltiplas strings e as concatena ou combina horizontalmente. Nossas próximas duas funções vão de mãos dadas. Imread lê a forma de imagem de cada matriz e im2double converte a matriz dessa imagem em forma double, que é necessária para a função SVD. As duas próximas também vão de mãos dadas com desktobind e binetodes, que convertem strings binárias em decimais e vice-versa. Finalmente, a função de caractere converte um número decimal em um caractere.

E agora para os principais passos da nossa implementação. Primeiro, pegamos uma mensagem, a convertemos para ASCII, e então a convertemos em binário. Em seguida, dividimos nossa imagem em blocos de quatro por quatro pixels. Então realizamos SVD em cada e todos os blocos de pixels. Então fomos para a matriz S e ajustamos o quarto valor singular com base no dígito binário. A razão pela qual fizemos o quarto valor singular é porque é o menos significativo e, portanto, mudá-lo afetará menos a composição da imagem. E finalmente, pegamos cada um dos blocos de quatro por quatro ajustados e os reagrupamos na imagem. Então esta imagem é a imagem na qual vamos esconder nossa mensagem. Vamos começar lendo essa imagem e depois convertendo-a em números duplos. Então vamos criar nossa mensagem, olhar seu comprimento e depois convertê-la em números duplos e depois para binário. Então vamos criar uma string vazia, que usaremos em um loop for para carregar todos os dígitos binários e depois adicionar um dois ao final. Isso será útil mais tarde. Vamos olhar o tamanho da imagem e depois definir isbreaking como falso. Isso nos ajudará a sair deste próximo loop for. Este é o loop for duplo que usamos para esconder a mensagem na imagem. Esta primeira parte do loop for duplo percorre cada matriz de quatro por quatro pixels em toda a imagem. Então, para cada matriz de quatro por quatro, pegamos o SVD e depois usamos esta função Sbig para acessar facilmente o quarto valor singular. Em seguida, escondemos um bit em cada matriz de quatro por quatro. Agora, o bit é um um ou zero, dependendo da localização de quatro por quatro na matriz e do índice do bit na string vazia. Se for um um, que temos aqui, simplesmente mudamos este quarto valor singular para um zero. Mas se o bit que estamos escondendo for um zero, é um pouco mais complicado. Este trecho de código aqui é uma proteção que mudará o segundo, terceiro ou quarto valores singulares se algum deles estiver muito próximo de zero. Isso ocorre porque nosso software de decodificação pode pensar que o bit escondido é um um, em vez do zero que realmente é. Então usamos o último caractere da string vazia, o dois, para sair do loop for duplo mudando o booleano isbreaking para true. Depois disso, realizamos o SVD em cada matriz com o objetivo de reconstruir os blocos de quatro por quatro que compõem a imagem. Depois disso, colocamos cada novo bloco de quatro por quatro na imagem antiga para fazer a nova imagem. Agora que codificamos nossa imagem, é hora de decodificá-la. Então, para começar o processo de decodificação, começamos fazendo uma string vazia chamada newM para a nova mensagem e verificamos o tamanho da nova imagem, embora deva ser o mesmo que o anterior. Em seguida, percorremos cada matriz de quatro por quatro usando um loop duplo, realizamos SVD em cada uma dessas matrizes e então verificamos o valor de S. E se estiver muito próximo de zero, então vamos dar um um. E se estiver significativamente acima de zero, então retornamos um zero. E então, uma vez que terminar de percorrer tudo isso, vai terminar. Então vamos criar uma nova variável de string chamada steglab. Apenas por diversão, vamos colocar "mensagem colon" para nos dizer que a mensagem está a caminho. Vamos usar outro loop duplo, e essencialmente ele vai pegar cada conjunto de oito bits e combiná-los usando a função de concatenação de strings. E então vamos converter isso em ASCII. E então vamos converter cada ASCII em um caractere e vamos combinar todos eles em uma variável de string que mencionamos anteriormente, stack mix, essencialmente, isso deve ser carregado nesta nova string e decodificar a imagem. Então vamos rodar isso agora, e estamos recebendo nossas duas imagens de volta, que mostramos usando figure imshow.  
